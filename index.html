
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Otterly data structure</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;json&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="json">json</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
          </li>
          <li>
            <a href="#authentication" class="toc-h1 toc-link" data-title="Authentication">Authentication</a>
          </li>
          <li>
            <a href="#users" class="toc-h1 toc-link" data-title="Users">Users</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#users-path" class="toc-h2 toc-link" data-title="Path">Path</a>
                  </li>
                  <li>
                    <a href="#users-structure" class="toc-h2 toc-link" data-title="Structure">Structure</a>
                  </li>
                  <li>
                    <a href="#users-subcollection-private" class="toc-h2 toc-link" data-title="Subcollection : Private">Subcollection : Private</a>
                        <ul class="toc-list-h3">
                            <li>
                              <a href="#users-subcollection-private-path" class="toc-h3 toc-link" data-title="Path">Path</a>
                            </li>
                            <li>
                              <a href="#users-subcollection-private-structure" class="toc-h3 toc-link" data-title="Structure">Structure</a>
                            </li>
                        </ul>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#dishes" class="toc-h1 toc-link" data-title="Dishes">Dishes</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#dishes-path" class="toc-h2 toc-link" data-title="Path">Path</a>
                  </li>
                  <li>
                    <a href="#dishes-structure" class="toc-h2 toc-link" data-title="Structure">Structure</a>
                        <ul class="toc-list-h3">
                            <li>
                              <a href="#dishes-structure-categoryinfo" class="toc-h3 toc-link" data-title="categoryInfo">categoryInfo</a>
                            </li>
                            <li>
                              <a href="#dishes-structure-restaurantdetails" class="toc-h3 toc-link" data-title="restaurantDetails">restaurantDetails</a>
                            </li>
                        </ul>
                  </li>
                  <li>
                    <a href="#dishes-subcollection-options" class="toc-h2 toc-link" data-title="Subcollection : Options">Subcollection : Options</a>
                        <ul class="toc-list-h3">
                            <li>
                              <a href="#dishes-subcollection-options-path" class="toc-h3 toc-link" data-title="Path">Path</a>
                            </li>
                            <li>
                              <a href="#dishes-subcollection-options-structure" class="toc-h3 toc-link" data-title="Structure">Structure</a>
                            </li>
                        </ul>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#restaurants" class="toc-h1 toc-link" data-title="Restaurants">Restaurants</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#restaurants-path" class="toc-h2 toc-link" data-title="Path">Path</a>
                  </li>
                  <li>
                    <a href="#restaurants-structure" class="toc-h2 toc-link" data-title="Structure">Structure</a>
                        <ul class="toc-list-h3">
                            <li>
                              <a href="#restaurants-structure-address" class="toc-h3 toc-link" data-title="address">address</a>
                            </li>
                        </ul>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#carts" class="toc-h1 toc-link" data-title="Carts">Carts</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#carts-path" class="toc-h2 toc-link" data-title="Path">Path</a>
                  </li>
                  <li>
                    <a href="#carts-structure" class="toc-h2 toc-link" data-title="Structure">Structure</a>
                        <ul class="toc-list-h3">
                            <li>
                              <a href="#carts-structure-orderdishes" class="toc-h3 toc-link" data-title="orderDishes">orderDishes</a>
                            </li>
                        </ul>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#paymentrequests" class="toc-h1 toc-link" data-title="PaymentRequests">PaymentRequests</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#paymentrequests-path" class="toc-h2 toc-link" data-title="Path">Path</a>
                  </li>
                  <li>
                    <a href="#paymentrequests-structure" class="toc-h2 toc-link" data-title="Structure">Structure</a>
                        <ul class="toc-list-h3">
                            <li>
                              <a href="#paymentrequests-structure-paymentinstruction" class="toc-h3 toc-link" data-title="paymentInstruction">paymentInstruction</a>
                            </li>
                            <li>
                              <a href="#paymentrequests-structure-paymenterror" class="toc-h3 toc-link" data-title="paymentError">paymentError</a>
                            </li>
                        </ul>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#orders" class="toc-h1 toc-link" data-title="Orders">Orders</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#orders-path" class="toc-h2 toc-link" data-title="Path">Path</a>
                  </li>
                  <li>
                    <a href="#orders-structure" class="toc-h2 toc-link" data-title="Structure">Structure</a>
                        <ul class="toc-list-h3">
                            <li>
                              <a href="#orders-structure-orderstatus" class="toc-h3 toc-link" data-title="orderStatus">orderStatus</a>
                            </li>
                            <li>
                              <a href="#orders-structure-ordererror" class="toc-h3 toc-link" data-title="orderError">orderError</a>
                            </li>
                            <li>
                              <a href="#orders-structure-paymentdetails" class="toc-h3 toc-link" data-title="paymentDetails">paymentDetails</a>
                            </li>
                            <li>
                              <a href="#orders-structure-orderdishes" class="toc-h3 toc-link" data-title="orderDishes">orderDishes</a>
                            </li>
                        </ul>
                  </li>
              </ul>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a> version 1.0 </a></li>
            <li><a> updated 20/01/2019 </a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>Welcome to the Otterly data structure document. This page outlines the different classes and data-structure utilised in the firestore backend for Otterly.</p>
<h1 id='authentication'>Authentication</h1>
<p>Autorization takes place in the context of firebase authentication. Primarily we use three auth providers - Google, Facebook, and Phone authentication. There is no password involved.</p>

<p>More info on firebase authentication can be found in the <a href="https://https//firebase.google.com/docs/auth/">official docs</a>.</p>

<p>The authentication details are stored automatically in the firebase authentication database, and some details are correspondingly stored in the <a href="#users"><code>users</code></a> collection.</p>
<h1 id='users'>Users</h1>
<p>Contains non strictly-confidential information about a user.</p>
<h2 id='users-path'>Path</h2>
<p><code>/users/{user}</code></p>

<p>where <code>{user}</code> is the <code>uid</code> obtained from firebase authentication.</p>
<h2 id='users-structure'>Structure</h2>
<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Notes</th>
</tr>
</thead><tbody>
<tr>
<td>uid</td>
<td>string</td>
<td>Unique ID for the user obtained from firebase auth</td>
<td>[required]</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>Full name of the user obtained from firebase auth, or from the app in case of phone auth</td>
<td>[required]</td>
</tr>
<tr>
<td>photoUrl</td>
<td>string</td>
<td>URL of the user&#39;s profile image. Updates on each login in case of third-party.</td>
<td>[optional]</td>
</tr>
<tr>
<td>phone</td>
<td>string</td>
<td>Full phone number of the user including the country code</td>
<td>[required] if phone authentication is used. [optional] or [null] otherwise</td>
</tr>
<tr>
<td>email</td>
<td>string</td>
<td>Email address of the user</td>
<td>[required] if any auth method apart from phone is used. [optional] or [null] otherwise</td>
</tr>
<tr>
<td>createdAt</td>
<td>timestamp</td>
<td>Timestamp of when the user was created</td>
<td>[required] - automatically generated by a cloud function</td>
</tr>
<tr>
<td>squareId</td>
<td>string</td>
<td>A unique square ID of the user</td>
<td>[required] - automatically generated by a cloud function once a user is registered to square</td>
</tr>
<tr>
<td>currentLocation</td>
<td>geopoint</td>
<td>Lat-long of the current location of the user</td>
<td>[optional]</td>
</tr>
<tr>
<td>currentAddress</td>
<td>string</td>
<td>A human readable (address) format of the current location to show in the application</td>
<td>[optional]</td>
</tr>
<tr>
<td>marketingConsent</td>
<td>boolean</td>
<td>Whether the user has given us consent to send marketing communications</td>
<td>[required] <code>default: false</code></td>
</tr>
</tbody></table>

<aside class="notice">
One of either <code>phone</code> or <code>email</code> is required for each user. We'll use email as the default contact method, unless it is not present.
</aside>
<h2 id='users-subcollection-private'>Subcollection : Private</h2>
<p>The private subcollection contains the private data about a user such as payments and personal preferences. This is stored in a separate subcollection to avoid exposing everytime a user object is fetched</p>
<h3 id='users-subcollection-private-path'>Path</h3>
<p><code>/users/{user}/private/payment</code></p>
<h3 id='users-subcollection-private-structure'>Structure</h3>
<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Notes</th>
</tr>
</thead><tbody>
<tr>
<td>defaultPaymentMethod</td>
<td>map of type <a href="#users-subcollection-private-structure-card"><code>card</code></a></td>
<td>Information about the default payment method of the user</td>
<td>[optional]</td>
</tr>
<tr>
<td>paymentMethods</td>
<td>array of <a href="#users-subcollection-private-structure-card"><code>card</code></a></td>
<td>All the cards a user has attached to their account. They can pick any of these to pay for a purchase</td>
<td>[optional]</td>
</tr>
</tbody></table>
<h4 id='users-subcollection-private-structure-card'>card</h4>
<p><code>card : map</code></p>

<p>Information about cards used to take payments from the square API and exposable information to show to the UI</p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Notes</th>
</tr>
</thead><tbody>
<tr>
<td>squareId</td>
<td>string</td>
<td>Unique ID of the card used to take payments</td>
<td>[required]</td>
</tr>
<tr>
<td>lastFourDigits</td>
<td>string</td>
<td>Last four digits of the card</td>
<td>[required]</td>
</tr>
<tr>
<td>cardBrand</td>
<td>string</td>
<td>The brand of the card</td>
<td>[required]</td>
</tr>
</tbody></table>
<h1 id='dishes'>Dishes</h1>
<p>Contains information about a dish</p>
<h2 id='dishes-path'>Path</h2>
<p><code>/dishes/{dish}</code></p>

<p>where <code>{dish}</code> is an automatically generated uid for a dish</p>
<h2 id='dishes-structure'>Structure</h2>
<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Notes</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>string</td>
<td>Unique ID for the dish. Same as the document name</td>
<td>[required]</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>The display name of the dish</td>
<td>[required]</td>
</tr>
<tr>
<td>originalPrice</td>
<td>number</td>
<td>The original price of the dish (includes VAT in the UK)</td>
<td>[required]</td>
</tr>
<tr>
<td>maxQuantity</td>
<td>number</td>
<td>Restricts the number of the same item that can be bought at the same time</td>
<td>[optional]</td>
</tr>
<tr>
<td>featured</td>
<td>boolean</td>
<td>Whether this item is featured in the restaurant&#39;s menu</td>
<td>[optional]</td>
</tr>
<tr>
<td>categoryInfo</td>
<td>map of type <code>categoryInfo</code></td>
<td>A map containing information about the category(s) this dish belongs to, and the display order</td>
<td>[optional]</td>
</tr>
<tr>
<td>averagePreparationTime</td>
<td>number</td>
<td>Time it takes for the dish to be prepared, on average (in seconds)</td>
<td>[optional]</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>A description of the dish</td>
<td>[optional]</td>
</tr>
<tr>
<td>imageUrl</td>
<td>string</td>
<td>Image associated with the dish</td>
<td>[optional]</td>
</tr>
<tr>
<td>rating</td>
<td>number</td>
<td>The average rating gathered from the reviews posted about this dish</td>
<td>[optional]</td>
</tr>
<tr>
<td>totalRatings</td>
<td>number</td>
<td>The number of ratings that have been published about this dish</td>
<td>[optional]</td>
</tr>
<tr>
<td>goesWellWith</td>
<td>arrary[<code>{dish}</code>]</td>
<td>An array that contains dish ids of the dishes that pair well with this product</td>
<td>[optional]</td>
</tr>
<tr>
<td>ingredients</td>
<td>array[<code>string</code> ]</td>
<td>An array containing ingredients of this dish in lowercase formatted strings</td>
<td>[optional]</td>
</tr>
<tr>
<td>tags</td>
<td>array[<code>string</code>]</td>
<td>Any tags associated with the dish - e.g. vegan, vegetarian, halal</td>
<td>[optional]</td>
</tr>
<tr>
<td>restaurantDetails</td>
<td>map of type <a href="#dishes-structure-restaurantdetails"><code>restaurantDetails</code></a></td>
<td>A map containing brief information about the restaurant</td>
<td>[required]</td>
</tr>
</tbody></table>
<h3 id='dishes-structure-categoryinfo'>categoryInfo</h3>
<p><code>categoryInfo: map of map with keys as categorySlug</code>
below is the information on what each key <code>categorySlug</code> has as ivalues.</p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Notes</th>
</tr>
</thead><tbody>
<tr>
<td>categoryText</td>
<td>string</td>
<td>Category text to show in the UI</td>
<td>[required]</td>
</tr>
<tr>
<td>displayOrder</td>
<td>number</td>
<td>Dispplay order of this dish in the specific category. A simple index value. In case not present, the dish is inserted at the bottom of the list</td>
<td>[optional]</td>
</tr>
</tbody></table>
<h3 id='dishes-structure-restaurantdetails'>restaurantDetails</h3>
<p><code>restaurantDetails : map</code></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Notes</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>string</td>
<td>Unique ID of the restaurant to which this dish belongs</td>
<td>[required]</td>
</tr>
<tr>
<td>firestoreRef</td>
<td>reference</td>
<td>reference to the restaurant object</td>
<td>[required]</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>Name of the restaurant</td>
<td>[required]</td>
</tr>
<tr>
<td>imageUrl</td>
<td>string</td>
<td>URL to the image of the restaurant</td>
<td>[optional]</td>
</tr>
<tr>
<td>address</td>
<td>map of type <a href="#dishes-structure-restaurantdetails-address"><code>address</code></a></td>
<td>Details about location of the restaurant</td>
<td>[required]</td>
</tr>
</tbody></table>
<h4 id='dishes-structure-restaurantdetails-address'>address</h4>
<p><code>address : map</code></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Notes</th>
</tr>
</thead><tbody>
<tr>
<td>line1</td>
<td>string</td>
<td>Line 1 of the address</td>
<td>[required]</td>
</tr>
<tr>
<td>line2</td>
<td>string</td>
<td>Line 2 of the address</td>
<td>[optional]</td>
</tr>
<tr>
<td>city</td>
<td>string</td>
<td>City or town of the restaurant</td>
<td>[required]</td>
</tr>
<tr>
<td>postcode</td>
<td>string</td>
<td>Postcode or zipcode of the restaurant</td>
<td>[optional]</td>
</tr>
<tr>
<td>location</td>
<td>geopoint</td>
<td>Lat-long co-ordinates of the restaurant</td>
<td>[required]</td>
</tr>
</tbody></table>
<h2 id='dishes-subcollection-options'>Subcollection : Options</h2>
<p>Some dishes contain options such as size, flavours, condimends, and extras. This information is contained in the options subcollection</p>
<h3 id='dishes-subcollection-options-path'>Path</h3>
<p><code>/dishes/{dish}/options/{option}</code></p>

<p>where <code>{option}</code> is a unique options group slug</p>
<h3 id='dishes-subcollection-options-structure'>Structure</h3>
<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Notes</th>
</tr>
</thead><tbody>
<tr>
<td>optionsGroupSlug</td>
<td>string</td>
<td>Options group slug to identify this group of options</td>
<td>[optional]</td>
</tr>
<tr>
<td>optionsGroupText</td>
<td>string</td>
<td>The text to show on the UI (formatted)</td>
<td>[required]</td>
</tr>
<tr>
<td>displayOrder</td>
<td>number</td>
<td>The display order of this options group in the UI. Starts at 0</td>
<td>[required]</td>
</tr>
<tr>
<td>maximumChoices</td>
<td>number</td>
<td>The maximum number of selections a user is allowed to make. 0 implies no restrictions</td>
<td>[required]</td>
</tr>
<tr>
<td>minimumChoices</td>
<td>number</td>
<td>The minimum number of selections required from a user. 0 implies no minimum</td>
<td>[required]</td>
</tr>
<tr>
<td>freeChoices</td>
<td>number</td>
<td>The number of options that are free to select. 0 implies no free selections</td>
<td>[required]</td>
</tr>
<tr>
<td>options</td>
<td>array<a href="#dishes-subcollection-options-structure-option">[<code>option</code>]</a></td>
<td>An array of options</td>
<td>[required]</td>
</tr>
</tbody></table>
<h4 id='dishes-subcollection-options-structure-option'>option</h4>
<p><code>option : map</code></p>

<p>Map of an option within an option group</p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Notes</th>
</tr>
</thead><tbody>
<tr>
<td>outOfStock</td>
<td>boolean</td>
<td>Whether an option is out of stock</td>
<td>[optional]</td>
</tr>
<tr>
<td>optionSlug</td>
<td>string</td>
<td>A lowercase slug of the option</td>
<td>[required]</td>
</tr>
<tr>
<td>optionText</td>
<td>string</td>
<td>The text of the option to be displayed in the UI</td>
<td>[required]</td>
</tr>
<tr>
<td>price</td>
<td>number</td>
<td>If the option carries a price, it is carried here</td>
<td>[optional]</td>
</tr>
</tbody></table>
<h1 id='restaurants'>Restaurants</h1>
<p>Contains information about restaurants</p>
<h2 id='restaurants-path'>Path</h2>
<p><code>/restaurants/{restaurant}</code></p>

<p>where <code>{restaurant}</code> is an automatically generated uid for a restaurant</p>
<h2 id='restaurants-structure'>Structure</h2>
<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Notes</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>string</td>
<td>Unique ID for the restaurant. Same as the document name</td>
<td>[required]</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>The display name of the restaurant</td>
<td>[required]</td>
</tr>
<tr>
<td>imageUrl</td>
<td>string</td>
<td>The image associated with the restaurant</td>
<td>[optional]</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>A description of the restaurant</td>
<td>[optional]</td>
</tr>
<tr>
<td>phone</td>
<td>string</td>
<td>Phone number of the restaurant</td>
<td>[optional]</td>
</tr>
<tr>
<td>address</td>
<td>map of type <a href="#restaurants-structure--address"><code>address</code></a></td>
<td>Details about location of the restaurant</td>
<td>[required]</td>
</tr>
<tr>
<td>categoriesDisplayOrder</td>
<td>arrary of <code>categorySlug</code></td>
<td>Contains information about the displayOrder of the categories. When updating, a new instance has to be created since firestore does not allow order operations</td>
<td>[optional]</td>
</tr>
</tbody></table>
<h3 id='restaurants-structure-address'>address</h3>
<p><code>address : map</code></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Notes</th>
</tr>
</thead><tbody>
<tr>
<td>line1</td>
<td>string</td>
<td>Line 1 of the address</td>
<td>[required]</td>
</tr>
<tr>
<td>line2</td>
<td>string</td>
<td>Line 2 of the address</td>
<td>[optional]</td>
</tr>
<tr>
<td>city</td>
<td>string</td>
<td>City or town of the restaurant</td>
<td>[required]</td>
</tr>
<tr>
<td>postcode</td>
<td>string</td>
<td>Postcode or zipcode of the restaurant</td>
<td>[optional]</td>
</tr>
<tr>
<td>location</td>
<td>geopoint</td>
<td>Lat-long co-ordinates of the restaurant</td>
<td>[required]</td>
</tr>
</tbody></table>
<h1 id='carts'>Carts</h1>
<p>Contains carts for users.</p>
<h2 id='carts-path'>Path</h2>
<p><code>/carts/{cart}</code></p>

<p>where <code>{cart}</code> is the uid of a user who is adding items to the cart.</p>
<h2 id='carts-structure'>Structure</h2>
<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Notes</th>
</tr>
</thead><tbody>
<tr>
<td>uid</td>
<td>string</td>
<td>Unique ID for the user obtained from firebase auth</td>
<td>[required]</td>
</tr>
<tr>
<td>totalDishes</td>
<td>number</td>
<td>Total number of dishes (items) in the cart</td>
<td>[required]</td>
</tr>
<tr>
<td>totalPriceBeforeDiscount</td>
<td>Total price of the dishes before discount</td>
<td>[required]</td>
<td></td>
</tr>
<tr>
<td>totalPriceAfterDiscount</td>
<td>Total price of the dishes after discount</td>
<td>[required]</td>
<td></td>
</tr>
<tr>
<td>expectBy</td>
<td>timestamp</td>
<td>Timestamp of when the user can expect this order</td>
<td>[optional]</td>
</tr>
<tr>
<td>totalPreparationTime</td>
<td>number</td>
<td>Total estimated preparation time. In case of one dish, it will be simply the current preparation time. In case of multiple dishes / quantities, this has to be calculated on the server side</td>
<td>[optional]</td>
</tr>
<tr>
<td>createdAt</td>
<td>timestamp</td>
<td>Timestamp of when the cart was created</td>
<td>[required] generated automatically by a cloud function</td>
</tr>
<tr>
<td>specialRequests</td>
<td>string</td>
<td>Any special requests that the user wants conveyed to the restaurant</td>
<td>[optional]</td>
</tr>
<tr>
<td>restaurantDetails</td>
<td>map of type <a href="#dishes-structure-restaurantdetails"><code>restaurantDetails</code></a></td>
<td>A map containing brief information about the restaurant</td>
<td>[required]</td>
</tr>
<tr>
<td>dishes</td>
<td>map of type <a href="#orderdishes"><code>orderDishes</code></a></td>
<td>A map containing all the dishes that are added</td>
<td>[required]</td>
</tr>
</tbody></table>
<h3 id='carts-structure-orderdishes'>orderDishes</h3>
<p><code>orderDishes: map with key {dishId}</code>
<aside class="notice">
This map is slightly different than others. It uses <code>dishId</code> as key. 
</aside></p>

<table><thead>
<tr>
<th>Values</th>
<th>Type</th>
<th>Description</th>
<th>Notes</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>string</td>
<td>Display name of the dish</td>
<td>[required]</td>
</tr>
<tr>
<td>originalPrice</td>
<td>number</td>
<td>The original price of the dish (includes VAT in the UK)</td>
<td>[required]</td>
</tr>
<tr>
<td>currentPreparationTime</td>
<td>number</td>
<td>The current preparation time estimate</td>
<td>[optional]</td>
</tr>
<tr>
<td>lockedPrice</td>
<td>number</td>
<td>The price at the time when the item was added to the cart. In case of an item not being dynamic, this is equal to the original price</td>
<td>[required]</td>
</tr>
<tr>
<td>addedAt</td>
<td>timestamp</td>
<td>The timestamp of when the product was added to the cart</td>
<td>[required]</td>
</tr>
<tr>
<td>lockedUntil</td>
<td>timestamp</td>
<td>The timestamp until the price is locked</td>
<td>[optional]</td>
</tr>
<tr>
<td>imageUrl</td>
<td>string</td>
<td>Image associated with the dish</td>
<td>[optional]</td>
</tr>
<tr>
<td>totalOptionsPrice</td>
<td>number</td>
<td>Total price of the options if any options were selected</td>
<td>[optional]</td>
</tr>
<tr>
<td>selectedOptions</td>
<td>map of type <code>selectedOptions</code></td>
<td>Defines the selected options</td>
<td>[optional]</td>
</tr>
</tbody></table>
<h4 id='carts-structure-orderdishes-selectedoptions'>selectedOptions</h4>
<p><code>selectedOptions: map with key {optionsGroupSlug}</code></p>

<table><thead>
<tr>
<th>Values</th>
<th>Type</th>
<th>Description</th>
<th>Notes</th>
</tr>
</thead><tbody>
<tr>
<td><code>{optionSlug}</code></td>
<td>map of type <code>selectedOption</code></td>
<td>Map containing information about specific option(s) selected from an options group and their price</td>
<td>[required]</td>
</tr>
</tbody></table>
<h4 id='carts-structure-orderdishes-selectedoption'>selectedOption</h4>
<table><thead>
<tr>
<th>Values</th>
<th>Type</th>
<th>Description</th>
<th>Notes</th>
</tr>
</thead><tbody>
<tr>
<td>optionText</td>
<td>string</td>
<td>The text of the option to be displayed in the UI</td>
<td>[required]</td>
</tr>
<tr>
<td>price</td>
<td>number</td>
<td>If the option carries a price, it is carried here</td>
<td>[optional]</td>
</tr>
</tbody></table>
<h1 id='paymentrequests'>PaymentRequests</h1>
<p>A paymentRequest document processes a payment for a given cart and generates an order upon successful confirmation</p>
<h2 id='paymentrequests-path'>Path</h2>
<p><code>/paymentRequests/{paymentRequest}</code></p>

<p>where <code>{paymentRequest}</code> is an auto-generated payment request ID.</p>
<h2 id='paymentrequests-structure'>Structure</h2>
<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Notes</th>
</tr>
</thead><tbody>
<tr>
<td>cartId</td>
<td>string</td>
<td>ID of the cart for which the payment is being processed. Note that this is the same as the user uid</td>
<td>[required]</td>
</tr>
<tr>
<td>paymentInstruction</td>
<td>map of type <code>paymentInstruction</code></td>
<td>Contains information about the cardId to charge or applePay/googlePay nonce</td>
<td>[required]</td>
</tr>
<tr>
<td>paymentStatus</td>
<td>string enum <code>completed</code>, <code>failed</code>, <code>actionNeeded</code></td>
<td>Contains information about the status</td>
<td>[optional] generated by server</td>
</tr>
<tr>
<td>paymentError</td>
<td>map of type <code>paymentError</code></td>
<td>Contains information about the error message associated with the payment</td>
<td>[optional] generated by server</td>
</tr>
</tbody></table>
<h3 id='paymentrequests-structure-paymentinstruction'>paymentInstruction</h3>
<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Notes</th>
</tr>
</thead><tbody>
<tr>
<td>applePayNonce</td>
<td>string</td>
<td>In case apple pay is used, the payments SDK will generate a nonce</td>
<td>[optional]</td>
</tr>
<tr>
<td>googlePayNonce</td>
<td>string</td>
<td>In case google pay is used, the payments SDK will generate a nonce</td>
<td>[optional]</td>
</tr>
<tr>
<td>cardId</td>
<td>string</td>
<td>ID of the card to be charged</td>
<td>[optional]</td>
</tr>
</tbody></table>
<h3 id='paymentrequests-structure-paymenterror'>paymentError</h3>
<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Notes</th>
</tr>
</thead><tbody>
<tr>
<td>errorCode</td>
<td>string</td>
<td>Code of the generated error</td>
<td>[optional]</td>
</tr>
<tr>
<td>adminMessage</td>
<td>string</td>
<td>Message to be recorded for the admin for debugging</td>
<td>[optional]</td>
</tr>
<tr>
<td>userMessage</td>
<td>string</td>
<td>In case there is any message deliverable to the user, add it here, otherwise a default &#39;Something went wrong, Try again&#39; type message will be shown to the user</td>
<td>[optional]</td>
</tr>
</tbody></table>
<h1 id='orders'>Orders</h1>
<p>A cart is converted to an order after a successful payment.</p>
<h2 id='orders-path'>Path</h2>
<p><code>/orders/{order}</code></p>

<p>where <code>{order}</code> is an a unique order id. This id corresponds to a successful paymentRequest id</p>
<h2 id='orders-structure'>Structure</h2>
<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Notes</th>
</tr>
</thead><tbody>
<tr>
<td>orderNumber</td>
<td>number</td>
<td>Order number. To be used for the purpose of collection and reference</td>
<td>[optional]</td>
</tr>
<tr>
<td>orderStatus</td>
<td>special map of type <code>orderStatus</code></td>
<td>Constructs five keys: <code>placed</code> - <code>confirmed</code> - <code>preparing</code> - <code>prepared</code>  - <code>completed</code> as the order progress changes</td>
<td>[required]</td>
</tr>
<tr>
<td>orderError</td>
<td>map of type <code>orderError</code></td>
<td>The error object in case the order fails</td>
<td>[optional]</td>
</tr>
<tr>
<td>uid</td>
<td>string</td>
<td>Unique ID for the user obtained from firebase auth</td>
<td>[required]</td>
</tr>
<tr>
<td>userName</td>
<td>string</td>
<td>Name of the user. For the purpose of order collection</td>
<td>[required]</td>
</tr>
<tr>
<td>totalDishes</td>
<td>number</td>
<td>Total number of dishes (items) in the cart</td>
<td>[required]</td>
</tr>
<tr>
<td>totalPriceBeforeDiscount</td>
<td>Total price of the dishes before discount</td>
<td>[required]</td>
<td></td>
</tr>
<tr>
<td>totalPriceAfterDiscount</td>
<td>Total price of the dishes after discount</td>
<td>[required]</td>
<td></td>
</tr>
<tr>
<td>expectBy</td>
<td>timestamp</td>
<td>Timestamp of when the user can expect this order</td>
<td>[optional]</td>
</tr>
<tr>
<td>totalPreparationTime</td>
<td>number</td>
<td>Total estimated preparation time. In case of one dish, it will simply be the current preparation time. In case of multiple dishes / quantities, this has to be calculated on the server side</td>
<td>[optional]</td>
</tr>
<tr>
<td>specialRequests</td>
<td>string</td>
<td>Any special requests that the user wants conveyed to the restaurant</td>
<td>[optional]</td>
</tr>
<tr>
<td>restaurantDetails</td>
<td>map of type <a href="#dishes-structure-restaurantdetails"><code>restaurantDetails</code></a></td>
<td>A map containing brief information about the restaurant</td>
<td>[required]</td>
</tr>
<tr>
<td>dishes</td>
<td>map of type <a href="#orderdishes"><code>orderDishes</code></a></td>
<td>A map containing all the dishes that are ordered</td>
<td>[required]</td>
</tr>
<tr>
<td>paymentDetails</td>
<td>map of type <code>paymentDetails</code></td>
<td>A map containing information regarding payments</td>
<td>[required]</td>
</tr>
</tbody></table>
<h3 id='orders-structure-orderstatus'>orderStatus</h3>
<p><code>orderStatus : map</code></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Notes</th>
</tr>
</thead><tbody>
<tr>
<td>startedAt</td>
<td>timeStamp</td>
<td>Timestamp of when the stage of the orderStaus started</td>
<td>[required]</td>
</tr>
<tr>
<td>finishedAt</td>
<td>timeStamp</td>
<td>Timestamp of when the stage of the orderStatus was finished</td>
<td>[required]</td>
</tr>
</tbody></table>
<h3 id='orders-structure-ordererror'>orderError</h3>
<p><code>orderError : map</code>
This key only exists when the order fails due to one of many reasons</p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Notes</th>
</tr>
</thead><tbody>
<tr>
<td>errorStatus</td>
<td>string</td>
<td>One of the following: <code>restaurantCancelled</code>, <code>userCancelled</code>, <code>otterlyCancelled</code></td>
<td>[required]</td>
</tr>
<tr>
<td>mssageAdmin</td>
<td>string</td>
<td>Error message for the records of adminn</td>
<td>[optional]</td>
</tr>
<tr>
<td>messageUser</td>
<td>string</td>
<td>Error message to show to the user</td>
<td>[optional]</td>
</tr>
</tbody></table>
<h3 id='orders-structure-paymentdetails'>paymentDetails</h3>
<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Notes</th>
</tr>
</thead><tbody>
<tr>
<td>squarePaymentId</td>
<td>string</td>
<td>ID of the payment</td>
<td>[required]</td>
</tr>
<tr>
<td>completedAt</td>
<td>timestamp</td>
<td>Timestamp of payment completion</td>
<td>[required]</td>
</tr>
</tbody></table>
<h3 id='orders-structure-orderdishes'>orderDishes</h3>
<p><code>orderDishes: map with key {dishId}</code>
<aside class="notice">
This map is slightly different than others. It uses <code>dishId</code> as key. 
</aside></p>

<table><thead>
<tr>
<th>Values</th>
<th>Type</th>
<th>Description</th>
<th>Notes</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>string</td>
<td>Display name of the dish</td>
<td>[required]</td>
</tr>
<tr>
<td>originalPrice</td>
<td>number</td>
<td>The original price of the dish (includes VAT in the UK)</td>
<td>[required]</td>
</tr>
<tr>
<td>currentPreparationTime</td>
<td>number</td>
<td>The current preparation time estimate</td>
<td>[optional]</td>
</tr>
<tr>
<td>lockedPrice</td>
<td>number</td>
<td>The price at the time when the item was added to the cart. In case of an item not being dynamic, this is equal to the original price</td>
<td>[required]</td>
</tr>
<tr>
<td>addedAt</td>
<td>timestamp</td>
<td>The timestamp of when the product was added to the cart</td>
<td>[required]</td>
</tr>
<tr>
<td>lockedUntil</td>
<td>timestamp</td>
<td>The timestamp until the price is locked</td>
<td>[optional]</td>
</tr>
<tr>
<td>imageUrl</td>
<td>string</td>
<td>Image associated with the dish</td>
<td>[optional]</td>
</tr>
<tr>
<td>totalOptionsPrice</td>
<td>number</td>
<td>Total price of the options if any options were selected</td>
<td>[optional]</td>
</tr>
<tr>
<td>selectedOptions</td>
<td>map of type <code>selectedOptions</code></td>
<td>Defines the selected options</td>
<td>[optional]</td>
</tr>
</tbody></table>
<h4 id='orders-structure-orderdishes-selectedoptions'>selectedOptions</h4>
<p><code>selectedOptions: map with key {optionsGroupSlug}</code></p>

<table><thead>
<tr>
<th>Values</th>
<th>Type</th>
<th>Description</th>
<th>Notes</th>
</tr>
</thead><tbody>
<tr>
<td><code>{optionSlug}</code></td>
<td>map of type <code>selectedOption</code></td>
<td>Map containing information about specific option(s) selected from an options group and their price</td>
<td>[required]</td>
</tr>
</tbody></table>
<h4 id='orders-structure-orderdishes-selectedoption'>selectedOption</h4>
<table><thead>
<tr>
<th>Values</th>
<th>Type</th>
<th>Description</th>
<th>Notes</th>
</tr>
</thead><tbody>
<tr>
<td>optionText</td>
<td>string</td>
<td>The text of the option to be displayed in the UI</td>
<td>[required]</td>
</tr>
<tr>
<td>price</td>
<td>number</td>
<td>If the option carries a price, it is carried here</td>
<td>[optional]</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="json">json</a>
          </div>
      </div>
    </div>
  </body>
</html>
